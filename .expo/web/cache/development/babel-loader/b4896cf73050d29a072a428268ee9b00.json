{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\haria\\\\SIMphony\\\\src\\\\components\\\\DayView.js\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport populateEvents from \"./Packer\";\nimport React from 'react';\nimport moment from 'moment';\nimport _ from 'lodash';\nvar LEFT_MARGIN = 60 - 1;\nvar CALENDER_HEIGHT = 2400;\nvar TEXT_LINE_HEIGHT = 17;\n\nfunction range(from, to) {\n  return Array.from(Array(to), function (_, i) {\n    return from + i;\n  });\n}\n\nvar DayView = function (_React$PureComponent) {\n  _inherits(DayView, _React$PureComponent);\n\n  function DayView(props) {\n    var _this;\n\n    _classCallCheck(this, DayView);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(DayView).call(this, props));\n    _this.calendarHeight = (props.end - props.start) * 100;\n    var width = props.width - LEFT_MARGIN;\n    var packedEvents = populateEvents(props.events, width, props.start);\n    var initPosition = _.min(_.map(packedEvents, 'top')) - _this.calendarHeight / (props.end - props.start);\n    initPosition = initPosition < 0 ? 0 : initPosition;\n    _this.state = {\n      _scrollY: initPosition,\n      packedEvents: packedEvents\n    };\n    return _this;\n  }\n\n  _createClass(DayView, [{\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      var width = nextProps.width - LEFT_MARGIN;\n      this.setState({\n        packedEvents: populateEvents(nextProps.events, width, nextProps.start)\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.props.scrollToFirst && this.scrollToFirst();\n    }\n  }, {\n    key: \"scrollToFirst\",\n    value: function scrollToFirst() {\n      var _this2 = this;\n\n      setTimeout(function () {\n        if (_this2.state && _this2.state._scrollY && _this2._scrollView) {\n          _this2._scrollView.scrollTo({\n            x: 0,\n            y: _this2.state._scrollY,\n            animated: true\n          });\n        }\n      }, 1);\n    }\n  }, {\n    key: \"_renderRedLine\",\n    value: function _renderRedLine() {\n      var offset = 100;\n      var format24h = this.props.format24h;\n      var _this$props = this.props,\n          width = _this$props.width,\n          styles = _this$props.styles;\n      var timeNowHour = moment().hour();\n      var timeNowMin = moment().minutes();\n      return React.createElement(View, {\n        key: \"timeNow\",\n        style: [styles.lineNow, {\n          top: offset * (timeNowHour - this.props.start) + offset * timeNowMin / 60,\n          width: width - 20\n        }],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66\n        }\n      });\n    }\n  }, {\n    key: \"_renderLines\",\n    value: function _renderLines() {\n      var _this3 = this;\n\n      var _this$props2 = this.props,\n          format24h = _this$props2.format24h,\n          start = _this$props2.start,\n          end = _this$props2.end;\n      var offset = this.calendarHeight / (end - start);\n      return range(start, end + 1).map(function (i, index) {\n        var timeText;\n\n        if (i === start) {\n          timeText = \"\";\n        } else if (i < 12) {\n          timeText = !format24h ? i + \" AM\" : i;\n        } else if (i === 12) {\n          timeText = !format24h ? i + \" PM\" : i;\n        } else if (i === 24) {\n          timeText = !format24h ? \"12 AM\" : 0;\n        } else {\n          timeText = !format24h ? i - 12 + \" PM\" : i;\n        }\n\n        var _this3$props = _this3.props,\n            width = _this3$props.width,\n            styles = _this3$props.styles;\n        return [React.createElement(Text, {\n          key: \"timeLabel\" + i,\n          style: [styles.timeLabel, {\n            top: offset * index - 6\n          }],\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100\n          }\n        }, timeText), i === start ? null : React.createElement(View, {\n          key: \"line\" + i,\n          style: [styles.line, {\n            top: offset * index,\n            width: width - 20\n          }],\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 107\n          }\n        }), React.createElement(View, {\n          key: \"lineHalf\" + i,\n          style: [styles.line, {\n            top: offset * (index + 0.5),\n            width: width - 20\n          }],\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112\n          }\n        })];\n      });\n    }\n  }, {\n    key: \"_renderTimeLabels\",\n    value: function _renderTimeLabels() {\n      var _this$props3 = this.props,\n          styles = _this$props3.styles,\n          start = _this$props3.start,\n          end = _this$props3.end;\n      var offset = this.calendarHeight / (end - start);\n      return range(start, end).map(function (item, i) {\n        return React.createElement(View, {\n          key: \"line\" + i,\n          style: [styles.line, {\n            top: offset * i\n          }],\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128\n          }\n        });\n      });\n    }\n  }, {\n    key: \"_onEventTapped\",\n    value: function _onEventTapped(event) {\n      this.props.eventTapped(event);\n    }\n  }, {\n    key: \"_renderEvents\",\n    value: function _renderEvents() {\n      var _this4 = this;\n\n      var styles = this.props.styles;\n      var packedEvents = this.state.packedEvents;\n      var events = packedEvents.map(function (event, i) {\n        var style = {\n          left: event.left,\n          height: event.height,\n          width: event.width,\n          top: event.top\n        };\n        var eventColor = {\n          backgroundColor: event.color\n        };\n        var numberOfLines = Math.floor(event.height / TEXT_LINE_HEIGHT);\n        var formatTime = _this4.props.format24h ? 'HH:mm' : 'hh:mm A';\n        return React.createElement(TouchableOpacity, {\n          activeOpacity: 0.5,\n          onPress: function onPress() {\n            return _this4._onEventTapped(_this4.props.events[event.index]);\n          },\n          key: i,\n          style: [styles.event, style, event.color && eventColor],\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157\n          }\n        }, _this4.props.renderEvent ? _this4.props.renderEvent(event) : React.createElement(View, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 167\n          }\n        }, React.createElement(Text, {\n          numberOfLines: 1,\n          style: styles.eventTitle,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 168\n          }\n        }, event.title || 'Event'), numberOfLines > 1 ? React.createElement(Text, {\n          numberOfLines: numberOfLines - 1,\n          style: [styles.eventSummary],\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 172\n          }\n        }, event.summary || ' ') : null, numberOfLines > 2 ? React.createElement(Text, {\n          style: styles.eventTimes,\n          numberOfLines: 1,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 180\n          }\n        }, moment(event.start).format(formatTime), \" -\", ' ', moment(event.end).format(formatTime)) : null));\n      });\n      return React.createElement(View, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        }\n      }, React.createElement(View, {\n        style: {\n          marginLeft: LEFT_MARGIN\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        }\n      }, events));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      var styles = this.props.styles;\n      return React.createElement(ScrollView, {\n        ref: function ref(_ref) {\n          return _this5._scrollView = _ref;\n        },\n        contentContainerStyle: [styles.contentStyle, {\n          width: this.props.width\n        }],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        }\n      }, this._renderLines(), this._renderEvents(), this._renderRedLine());\n    }\n  }]);\n\n  return DayView;\n}(React.PureComponent);\n\nexport { DayView as default };","map":{"version":3,"sources":["C:/Users/haria/SIMphony/src/components/DayView.js"],"names":["populateEvents","React","moment","_","LEFT_MARGIN","CALENDER_HEIGHT","TEXT_LINE_HEIGHT","range","from","to","Array","i","DayView","props","calendarHeight","end","start","width","packedEvents","events","initPosition","min","map","state","_scrollY","nextProps","setState","scrollToFirst","setTimeout","_scrollView","scrollTo","x","y","animated","offset","format24h","styles","timeNowHour","hour","timeNowMin","minutes","lineNow","top","index","timeText","timeLabel","line","item","event","eventTapped","style","left","height","eventColor","backgroundColor","color","numberOfLines","Math","floor","formatTime","_onEventTapped","renderEvent","eventTitle","title","eventSummary","summary","eventTimes","format","marginLeft","ref","contentStyle","_renderLines","_renderEvents","_renderRedLine","PureComponent"],"mappings":"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","sourcesContent":["// @flow\nimport { View, Text, ScrollView, TouchableOpacity } from 'react-native';\nimport populateEvents from './Packer';\nimport React from 'react';\nimport moment from 'moment';\nimport _ from 'lodash';\n\nconst LEFT_MARGIN = 60 - 1;\n// const RIGHT_MARGIN = 10\nconst CALENDER_HEIGHT = 2400;\n// const EVENT_TITLE_HEIGHT = 15\nconst TEXT_LINE_HEIGHT = 17;\n// const MIN_EVENT_TITLE_WIDTH = 20\n// const EVENT_PADDING_LEFT = 4\n\nfunction range(from, to) {\n  return Array.from(Array(to), (_, i) => from + i);\n}\n\nexport default class DayView extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.calendarHeight = (props.end - props.start) * 100;\n    const width = props.width - LEFT_MARGIN;\n    const packedEvents = populateEvents(props.events, width, props.start);\n    let initPosition =\n      _.min(_.map(packedEvents, 'top')) -\n      this.calendarHeight / (props.end - props.start);\n    initPosition = initPosition < 0 ? 0 : initPosition;\n    this.state = {\n      _scrollY: initPosition,\n      packedEvents,\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    const width = nextProps.width - LEFT_MARGIN;\n    this.setState({\n      packedEvents: populateEvents(nextProps.events, width, nextProps.start),\n    });\n  }\n\n  componentDidMount() {\n    this.props.scrollToFirst && this.scrollToFirst();\n  }\n\n  scrollToFirst() {\n    setTimeout(() => {\n      if (this.state && this.state._scrollY && this._scrollView) {\n        this._scrollView.scrollTo({\n          x: 0,\n          y: this.state._scrollY,\n          animated: true,\n        });\n      }\n    }, 1);\n  }\n\n  _renderRedLine() {\n    const offset = 100;\n    const { format24h } = this.props;\n    const { width, styles } = this.props;\n    const timeNowHour = moment().hour();\n    const timeNowMin = moment().minutes();\n    return (\n      <View\n        key={`timeNow`}\n        style={[\n          styles.lineNow,\n          {\n            top:\n              offset * (timeNowHour - this.props.start) +\n              (offset * timeNowMin) / 60,\n            width: width - 20,\n          },\n        ]}\n      />\n    );\n  }\n\n  _renderLines() {\n    const { format24h, start, end } = this.props;\n    const offset = this.calendarHeight / (end - start);\n\n    return range(start, end + 1).map((i, index) => {\n      let timeText;\n      if (i === start) {\n        timeText = ``;\n      } else if (i < 12) {\n        timeText = !format24h ? `${i} AM` : i;\n      } else if (i === 12) {\n        timeText = !format24h ? `${i} PM` : i;\n      } else if (i === 24) {\n        timeText = !format24h ? `12 AM` : 0;\n      } else {\n        timeText = !format24h ? `${i - 12} PM` : i;\n      }\n      const { width, styles } = this.props;\n      return [\n        <Text\n          key={`timeLabel${i}`}\n          style={[styles.timeLabel, { top: offset * index - 6 }]}\n        >\n          {timeText}\n        </Text>,\n        i === start ? null : (\n          <View\n            key={`line${i}`}\n            style={[styles.line, { top: offset * index, width: width - 20 }]}\n          />\n        ),\n        <View\n          key={`lineHalf${i}`}\n          style={[\n            styles.line,\n            { top: offset * (index + 0.5), width: width - 20 },\n          ]}\n        />,\n      ];\n    });\n  }\n\n  _renderTimeLabels() {\n    const { styles, start, end } = this.props;\n    const offset = this.calendarHeight / (end - start);\n    return range(start, end).map((item, i) => {\n      return (\n        <View key={`line${i}`} style={[styles.line, { top: offset * i }]} />\n      );\n    });\n  }\n\n  _onEventTapped(event) {\n    this.props.eventTapped(event);\n  }\n\n  _renderEvents() {\n    const { styles } = this.props;\n    const { packedEvents } = this.state;\n    let events = packedEvents.map((event, i) => {\n      const style = {\n        left: event.left,\n        height: event.height,\n        width: event.width,\n        top: event.top,\n      };\n\n      const eventColor = {\n        backgroundColor: event.color,\n      };\n\n      // Fixing the number of lines for the event title makes this calculation easier.\n      // However it would make sense to overflow the title to a new line if needed\n      const numberOfLines = Math.floor(event.height / TEXT_LINE_HEIGHT);\n      const formatTime = this.props.format24h ? 'HH:mm' : 'hh:mm A';\n      return (\n        <TouchableOpacity\n          activeOpacity={0.5}\n          onPress={() =>\n            this._onEventTapped(this.props.events[event.index])\n          }\n          key={i} style={[styles.event, style, event.color && eventColor]}\n        >\n          {this.props.renderEvent ? (\n            this.props.renderEvent(event)\n          ) : (\n            <View>\n              <Text numberOfLines={1} style={styles.eventTitle}>\n                {event.title || 'Event'}\n              </Text>\n              {numberOfLines > 1 ? (\n                <Text\n                  numberOfLines={numberOfLines - 1}\n                  style={[styles.eventSummary]}\n                >\n                  {event.summary || ' '}\n                </Text>\n              ) : null}\n              {numberOfLines > 2 ? (\n                <Text style={styles.eventTimes} numberOfLines={1}>\n                  {moment(event.start).format(formatTime)} -{' '}\n                  {moment(event.end).format(formatTime)}\n                </Text>\n              ) : null}\n              </View>\n          )}\n        </TouchableOpacity>\n      );\n    });\n\n    return (\n      <View>\n        <View style={{ marginLeft: LEFT_MARGIN }}>{events}</View>\n      </View>\n    );\n  }\n\n  render() {\n    const { styles } = this.props;\n    return (\n      <ScrollView\n        ref={ref => (this._scrollView = ref)}\n        contentContainerStyle={[\n          styles.contentStyle,\n          { width: this.props.width },\n        ]}\n      >\n        {this._renderLines()}\n        {this._renderEvents()}\n        {this._renderRedLine()}\n      </ScrollView>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}